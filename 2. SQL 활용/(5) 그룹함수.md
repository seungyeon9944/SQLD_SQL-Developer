### 그룹 함수 (소계-총계 함수)

### ⭐`ROLLUP`

`ROLLUP (A,B,C)` 하면 **A,B,C로 그룹핑 + A,B로 그룹핑 + A로 그룹핑 + 총합계**

```sql
SELECT ORDER_DT, ORDER_ITEM, COUNT(*)
FROM STARBUCKS_ORDER
GROUP BY ROLLUP(ORDER_DT, ORDER_ITEM)
ORDER BY ORDER_DT;

# 날짜별, 주문음료별로 그룹핑 + 날짜별로 그룹핑 + 총합계
```

### `CUBE`

조합할 수 있는 모든 그룹에 대한 소계 집계

`CUBE (A,B,C)` 하면 A,B,C로 그룹핑 + A,B로 그룹핑 + A,C로 그룹핑 + B,C로 그룹핑 + A로 그룹핑 + B로 그룹핑 + C로 그룹핑 + 총합계 

✏️ *CUBE(A, B)랑 CUBE((A), (B))는 똑같은거임 ㅜㅜ! 총합계 무조건 있음*

```sql
SELECT ORDER_DT, ORDER_ITEM, COUNT(*)
FROM STARBUCKS_ORDER
GROUP BY CUBE(ORDER_DT, ORDER_ITEM)
ORDER BY ORDER_DT;

# 다음 쿼리와 같은 의미 !
SELECT ORDER_DT, ORDER_ITEM, COUNT(*)
FROM STARBUCKS_ORDER
GROUP BY ORDER_DT, ORDER_ITEM
UNION ALL
SELECT ORDER_DT, NULL, COUNT(*)
FROM STARBUCKS_ORDER
GROUP BY ORDER_DT
UNION ALL
SELECT NULL, ORDER_ITEM, COUNT(*)
FROM STARBUCKS_ORDER
GROUP BY ORDER_ITEM
UNION ALL
SELECT NULL, NULL, COUNT(*)
FROM STARBUCKS_ORDER
ORDER BY 1, 2; # 첫번째 쿼리인 ORDER_DT와 ORDER_ITEM으로 정렬
```

### ⭐`GROUPING SETS`

특정 항목에 대한 소계 계산

- `GROUPING SETS (A, B)`  - A / B
    
    ✏️*전체 소계x, 조합x*
    
- `GROUPING SETS (A, B, ( ))`  - A / B / 총합계
    
    ```sql
    SELECT PRODUCT_NO, GOGAK_NO, SUM(QTY) AS TOTAL_QTY
    FROM JUMUN
    GROUP BY GROUPING SETS(PRODUCT_NO, GOGAK_NO, ());
    # PRODUCT_NO별 SUM(QTY), GOGAK_NO별 SUM(QTY), SUM(QTY)의 총합이 출력
    ```
    
- `GROUPING SETS (A, ROLLUP(B))` - A / B / 총합계
- `GROUPING SETS (A, ROLLUP(B, C))` - A / B,C / B / 총합계
- `GROUPING SETS(A, B, ROLLUP(C))` - A / B / C / 총합계

### ⭐`GROUPING`

원하는 위치에 원하는 텍스트 출력

✏️ *GROUPING이나 GROUPING_ID 모두 **NULL이 된 경우 → 1** 반환 / **실제 데이터에서 온 경우 → 0** 반환*

```sql
SELECT ORDER_DT,
       GROUPING(ORDER_DT),
       COUNT(*)
  FROM STARBUCKS_ORDER
 GROUP BY ROLLUP(ORDER_DT)
 ORDER BY ORDER_DT;
 
 # 두번째 column에 GROUPING(ORDER_DT)가 있고 마지막 행에 합계 표시
```